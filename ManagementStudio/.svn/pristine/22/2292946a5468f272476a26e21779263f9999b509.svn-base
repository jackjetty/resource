package com.rising.management.dao.impl;

import java.math.BigDecimal;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Set;

import org.hibernate.Query;
import org.hibernate.SQLQuery;
import org.hibernate.Session;
import org.springframework.stereotype.Component;

import com.rising.management.bean.Business;
import com.rising.management.bean.OrderInfo;
import com.rising.management.bean.QQPermonthRecode;
import com.rising.management.dao.OrderInfoDao;

@Component("orderInfoDao")
public class OrderInfoDaoImpl extends BaseDaoImpl implements OrderInfoDao {

	@Override
	public Integer getOrderInfoListSize(String phoneNumber, Integer busId,
			String productId, Boolean success, Boolean failed, Date startDate,
			Date endDate, String payReturnCode, String targetNumber,String os,String client) {
		Query query = getQuery2(phoneNumber, busId, productId, success, failed,
				startDate, endDate, payReturnCode, targetNumber,os,client);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	@SuppressWarnings("unchecked")
	@Override
	public ArrayList<OrderInfo> getOrderInfo(String phoneNumber, Integer busId,
			String productId, Boolean success, Boolean failed, Integer start,
			Integer pageSize, Date startDate, Date endDate,
			String payReturnCode, String targetNumber,String os,String client) {
		Query query = getQuery(phoneNumber, busId, productId, success, failed,
				startDate, endDate, payReturnCode, targetNumber,os,client);
		query.setFirstResult(start);
		query.setMaxResults(pageSize);
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao;
	}

	@SuppressWarnings("unchecked")
	@Override
	public ArrayList<Object[]> getOrderInfoByTen(Date startDate, Date endDate,
			Integer payMoneyMin, Integer payMoneyMax) {
		Session session = getSession();
		SQLQuery query = null;
		if (payMoneyMin != null && payMoneyMax != null) {
			String sql = "select phonenumber,money from(select phonenumber,sum(paymoney) as money from RS_orderInfo where paystatus='成功' "
					+ "and ordertime >= :startDate and ordertime <= :endDate group by phoneNumber order by money desc)where"
					+ " money >= :payMoneyMin and money <= :payMoneyMax";
			query = session.createSQLQuery(sql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("payMoneyMin", payMoneyMin);
			query.setParameter("payMoneyMax", payMoneyMax);
		} else if (payMoneyMin != null) {
			String sql = "select phonenumber,money from(select phonenumber,sum(paymoney) as money from RS_orderInfo where paystatus='成功' and ordertime >= :startDate and ordertime <= :endDate group by phoneNumber order by money desc)where money >= :payMoneyMin";
			query = session.createSQLQuery(sql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("payMoneyMin", payMoneyMin);
		} else if (payMoneyMax != null) {
			String sql = "select phonenumber,money from(select phonenumber,sum(paymoney) as money from RS_orderInfo where paystatus='成功' and ordertime >= :startDate and ordertime <= :endDate group by phoneNumber order by money desc)where money <= :payMoneyMax";
			query = session.createSQLQuery(sql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("payMoneyMax", payMoneyMax);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		return ao;
	}

	private Query getQuery(String phoneNumber, Integer busId, String productId,
			Boolean success, Boolean failed, Date startDate, Date endDate,
			String payReturnCode, String targetNumber,String os,String client) {

		Session session = getSession();
		Query query = null;
		if(os!=null&&client!=null){
			String hql = "select new OrderInfo(a.phoneNumber,a.productId,a.targetNumber,a.payStatus,a.orderTime,a.payReturnCode,a.payMoney,a.sendScore,a.os,a.client,a.version) from OrderInfo a where a.os = :os and a.client like concat(concat('%',:client),'%') ";
			if (targetNumber == null) {
				if (busId != null && productId == null) {
					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						hql = hql + " and a.payReturnCode = :payReturnCode";
						if (success && failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}
				} else if (productId != null && busId != null) {
					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						hql = hql + " and a.payReturnCode = :payReturnCode";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}

				} else if (busId == null && productId == null) {

					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						hql = hql + " and a.payReturnCode = :payReturnCode";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}
				}
				
				
				
				
				///=====
				
				
			}else {
				hql = hql+" and a.targetNumber = :targetNumber";
				if (busId != null && productId == null) {
					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						hql = hql + " and a.payReturnCode = :payReturnCode";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}
				} else if (productId != null && busId != null) {
					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId = :productId  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						hql = hql + " and a.payReturnCode = :payReturnCode";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}

				} else if (busId == null && productId == null) {

					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						// hql = hql + " and a.payReturnCode = :payReturnCode";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}
				}
			}
			
		}else if(os!=null&&client==null){
			query=getQuery3(phoneNumber, busId, productId, success, failed, startDate, endDate, payReturnCode, targetNumber, os, query, session);
		}else if(os==null&&client!=null){
			query=getQuery4(phoneNumber, busId, productId, success, failed, startDate, endDate, payReturnCode, targetNumber, client, query, session);
		}else{
			query=getQuery5(phoneNumber, busId, productId, success, failed, startDate, endDate, payReturnCode, targetNumber, query, session);
		}
		return query;

	}

	private Query getQuery2(String phoneNumber, Integer busId,
			String productId, Boolean success, Boolean failed, Date startDate,
			Date endDate, String payReturnCode, String targetNumber,String os,String client) {

		Session session = getSession();
		Query query = null;
		if(os!=null&&client!=null){
			String hql = "select count(*) from OrderInfo a where a.os = :os and a.client like concat(concat('%',:client),'%') ";
			if (targetNumber == null) {
				if (busId != null && productId == null) {
					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						hql = hql + " and a.payReturnCode = :payReturnCode";
						if (success && failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}
				} else if (productId != null && busId != null) {
					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						hql = hql + " and a.payReturnCode = :payReturnCode";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}

				} else if (busId == null && productId == null) {

					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						hql = hql + " and a.payReturnCode = :payReturnCode";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}
				}
				
				
				
				
				///=====
				
				
			}else {
				hql = hql+" and a.targetNumber = :targetNumber";
				if (busId != null && productId == null) {
					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						hql = hql + " and a.payReturnCode = :payReturnCode";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("busId", busId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("busId", busId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}
				} else if (productId != null && busId != null) {
					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId = :productId  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						hql = hql + " and a.payReturnCode = :payReturnCode";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("productId", productId);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql
										+ " and a.productId =:productId order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("productId", productId);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}

				} else if (busId == null && productId == null) {

					if (phoneNumber != null && payReturnCode == null) {
						hql = hql
								+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
						if (success && failed) {
							hql = hql + " and a.payReturnCode is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && !failed) {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber == null) {
						// hql = hql + " and a.payReturnCode = :payReturnCode";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else if (payReturnCode != null && phoneNumber != null) {
						hql = hql
								+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
						if ((success && failed) || (!success && !failed)) {
							// hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("endDate", endDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate  order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("startDate", startDate);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("payReturnCode", payReturnCode);
								query.setParameter("phoneNumber", phoneNumber);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					} else {
						if (success && failed) {
							hql = hql + " and a.payStatus is not null";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (success && !failed) {
							hql = hql + " and a.payStatus ='成功'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else if (!success && failed) {
							hql = hql + " and a.payStatus ='失败'";
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						} else {
							if (startDate != null && endDate != null) {
								hql = hql
										+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate == null && endDate != null) {
								hql = hql
										+ " and a.orderTime <= :endDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("endDate", endDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else if (startDate != null && endDate == null) {
								hql = hql
										+ " and a.orderTime >= :startDate order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("startDate", startDate);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							} else {
								hql = hql + " order by a.orderTime desc";
								query = session.createQuery(hql);
								query.setParameter("targetNumber", targetNumber);
								query.setParameter("client", client);query.setParameter("os", os);
							}
						}
					}
				}
			}
			
		}else if(os!=null&&client==null){
			query=getQuery6(phoneNumber, busId, productId, success, failed, startDate, endDate, payReturnCode, targetNumber, os, query, session);
			
		}else if(os==null&&client!=null){
			query=getQuery7(phoneNumber, busId, productId, success, failed, startDate, endDate, payReturnCode, targetNumber, client, query, session);
		}else{
			query=getQuery8(phoneNumber, busId, productId, success, failed, startDate, endDate, payReturnCode, targetNumber, query, session);
		}
		return query;

	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPaySuccess(String id, Date startDate, Date endDate) {
		String hql = "from OrderInfo where productId = :productId and payStatus ='成功' and ordertime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayFailed(String id, Date startDate, Date endDate) {
		String hql = "from OrderInfo where productId = :productId and payStatus ='失败' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public double getAllPayMoney(String id, Date startDate, Date endDate) {
		String hql = "select sum(payMoney) as AllPayMoney from OrderInfo where productId = :productId and payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getAllPayPhoneNumbers(String id, Date startDate, Date endDate) {
		// String hql =
		// "select distinct phoneNumber from OrderInfo where productId = :productId and payStatus is not null and orderTime >= :startDate and orderTime <= :endDate";
		String hql = "select distinct phoneNumber from OrderInfo where productId = :productId and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPaySuccessPhoneNumbers(String id, Date startDate,
			Date endDate) {
		String hql = "select distinct phoneNumber from OrderInfo where productId = :productId and payStatus = '成功' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayFailedPhoneNumbers(String id, Date startDate,
			Date endDate) {
		String hql = "select distinct phoneNumber from OrderInfo where productId = :productId and payStatus = '失败' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayMoneyByBusiness(
			ArrayList<Business> ab, Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		for (Business business : ab) {
			String hql = "select sum(payMoney) as AllPayMoney from OrderInfo where busId = :busId and payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
			Query query = getSession().createQuery(hql);
			query.setInteger("busId", business.getBusId());
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			ArrayList<Double> ad = (ArrayList<Double>) query.list();
			Double allPayMoney = ad.get(0);
			if (allPayMoney == null) {
				map.put(business.getBtype(), 0.0);
			} else {
				map.put(business.getBtype(), allPayMoney);
			}
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPaySuccess(String id, Date startDate, Date endDate,
			String place) {
		String hql = "select a.phoneNumber from OrderInfo a,UserInfo b where b.address = :place and b.phoneNumber = a.phoneNumber and a.productId = :productId and a.payStatus ='成功' and a.orderTime >= :startDate and a.orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		query.setParameter("place", place);
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayFailed(String id, Date startDate, Date endDate,
			String place) {
		String hql = "select a.phoneNumber from OrderInfo a,UserInfo b where b.address = :place and b.phoneNumber = a.phoneNumber and a.productId = :productId and a.payStatus ='失败' and a.orderTime >= :startDate and a.orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		query.setParameter("place", place);
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public double getAllPayMoney(String id, Date startDate, Date endDate,
			String place) {
		String hql = "select sum(a.payMoney) as AllPayMoney from OrderInfo a,UserInfo b where b.address = :place and b.phoneNumber = a.phoneNumber and a.productId = :productId and a.payStatus ='成功' and a.orderTime >= :startDate and a.orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		query.setParameter("place", place);
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getAllPayPhoneNumbers(String id, Date startDate,
			Date endDate, String place) {
		String hql = "select distinct a.phoneNumber from OrderInfo a,UserInfo b where b.address = :place and b.phoneNumber = a.phoneNumber and a.productId = :productId and a.orderTime >= :startDate and a.orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		query.setParameter("place", place);
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPaySuccessPhoneNumbers(String id, Date startDate,
			Date endDate, String place) {
		String hql = "select distinct a.phoneNumber from OrderInfo a,UserInfo b where b.address = :place and b.phoneNumber = a.phoneNumber and a.productId = :productId and a.payStatus = '成功' and a.orderTime >= :startDate and a.orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		query.setParameter("place", place);
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayFailedPhoneNumbers(String id, Date startDate,
			Date endDate, String place) {
		String hql = "select distinct a.phoneNumber from OrderInfo a,UserInfo b where b.address = :place and b.phoneNumber = a.phoneNumber and a.productId = :productId and a.payStatus = '失败' and a.orderTime >= :startDate and a.orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("productId", id);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		query.setParameter("place", place);
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayMoneyByBusiness(
			ArrayList<Business> ab, Date startDate, Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		for (Business business : ab) {
			String hql = "select sum(a.payMoney) as AllPayMoney from OrderInfo a,UserInfo b where b.address = :place and b.phoneNumber = a.phoneNumber and a.busId = :busId and a.payStatus ='成功' and a.orderTime >= :startDate and a.orderTime <= :endDate";
			Query query = getSession().createQuery(hql);
			query.setInteger("busId", business.getBusId());
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
			ArrayList<Double> ad = (ArrayList<Double>) query.list();
			Double allPayMoney = ad.get(0);
			if (allPayMoney == null) {
				map.put(business.getBtype(), 0.0);
			} else {
				map.put(business.getBtype(), allPayMoney);
			}
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPaySuccess(String id, Integer busId, Date startDate,
			Date endDate) {
		String hql = "from OrderInfo where productId = :productId and payStatus ='成功'  ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayFailed(String id, Integer busId, Date startDate,
			Date endDate) {
		String hql = "from OrderInfo where productId = :productId and payStatus ='失败'  ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public double getAllPayMoney(String id, Integer busId, Date startDate,
			Date endDate) {
		String hql = "select sum(payMoney) as AllPayMoney from OrderInfo where productId = :productId and payStatus ='成功' ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getAllPayPhoneNumbers(String id, Integer busId,
			Date startDate, Date endDate) {
		// String hql =
		// "select distinct phoneNumber from OrderInfo where productId = :productId and payStatus is not null and orderTime >= :startDate and orderTime <= :endDate";
		String hql = "select distinct phoneNumber from OrderInfo where productId = :productId  ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPaySuccessPhoneNumbers(String id, Integer busId,
			Date startDate, Date endDate) {
		String hql = "select distinct phoneNumber from OrderInfo where productId = :productId and payStatus = '成功'  ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayFailedPhoneNumbers(String id, Integer busId,
			Date startDate, Date endDate) {
		String hql = "select distinct phoneNumber from OrderInfo where productId = :productId and payStatus = '失败'  ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayMoneyByBusinessAll(
			ArrayList<Business> ab, Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		for (Business business : ab) {
			String hql = "select sum(payMoney) as AllPayMoney from OrderInfo where   payStatus ='成功'  ";
			Query query = null;
			Integer busId = business.getBusId();
			if (busId == null) {
				if (startDate == null && endDate == null) {
					query = getSession().createQuery(hql);
				} else {
					hql = hql
							+ " and orderTime >= :startDate and orderTime <= :endDate ";
					query = getSession().createQuery(hql);
					query.setParameter("startDate", startDate);
					query.setParameter("endDate", endDate);
				}
			} else {
				if (startDate == null && endDate == null) {
					hql = hql + " and busId = :busId ";
					query = getSession().createQuery(hql);
					query.setInteger("busId", busId);
				} else {
					hql = hql
							+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId ";
					query = getSession().createQuery(hql);
					query.setInteger("busId", busId);
					query.setParameter("startDate", startDate);
					query.setParameter("endDate", endDate);
				}

			}
			ArrayList<Double> ad = (ArrayList<Double>) query.list();
			Double allPayMoney = ad.get(0);
			if (allPayMoney == null) {
				map.put(business.getBtype(), 0.0);
			} else {
				map.put(business.getBtype(), allPayMoney);
			}
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	public Double getAllPayMoneyByBusId(Integer busId, Date startDate,
			Date endDate) {
		// String hql =
		// " select sum(payMoney) as AllPayMoney from OrderInfo where  payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate ";
		String hql = " select sum(payMoney) as AllPayMoney from OrderInfo where  payStatus ='成功' ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId ";
				query = getSession().createQuery(hql);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			allPayMoney = 0.0;
		}
		return allPayMoney;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getSuccessTimes(String phoneNumber) {
		String hql = " from OrderInfo where phoneNumber = :phoneNumber and payStatus = '成功'";
		Query query = getSession().createQuery(hql);
		query.setParameter("phoneNumber", phoneNumber);
		ArrayList<OrderInfo> o = (ArrayList<OrderInfo>) query.list();
		return o.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getFailTimes(String phoneNumber) {
		String hql = " from OrderInfo where phoneNumber = :phoneNumber and payStatus = '失败'";
		Query query = getSession().createQuery(hql);
		query.setParameter("phoneNumber", phoneNumber);
		ArrayList<OrderInfo> o = (ArrayList<OrderInfo>) query.list();
		return o.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public double getAll(String productId, Date startDate, Date endDate,
			String place) {
		String hql = "select sum(a.payMoney) as AllPayMoney from OrderInfo a,UserInfo b where b.address = :place "
				+ " and a.productId = :productId and b.phoneNumber = a.phoneNumber  and a.payStatus ='成功' and a.orderTime >= :startDate and a.orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("place", place);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		query.setParameter("productId", productId);
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			allPayMoney = 0.0;
		}
		return allPayMoney;

	}

	@SuppressWarnings("unchecked")
	@Override
	public ArrayList<Date> getPayTime(Date startDate, Date endDate) {
		String hql = "select payTime from OrderInfo ";
		Query query = null;
		if (startDate == null && endDate == null) {
			query = getSession().createQuery(hql);
		} else {
			hql = hql + " where payTime >= :startDate and payTime <= :endDate ";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Date> pt = (ArrayList<Date>) query.list();

		return pt;
	}

	@SuppressWarnings("unchecked")
	public Integer getPaySuccess2(String id, Integer busId, Date startDate,
			Date endDate) {
		String hql = "from OrderInfo where  payStatus ='成功'  ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId and productId = :productId  ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId and productId = :productId";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	public Integer getPayFailed2(String id, Integer busId, Date startDate,
			Date endDate) {
		String hql = "from OrderInfo where  payStatus ='失败'  ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId and productId = :productId";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId and productId = :productId";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	public double getAllPayMoney2(String id, Integer busId, Date startDate,
			Date endDate) {
		String hql = "select sum(payMoney) as AllPayMoney from OrderInfo where  payStatus ='成功' ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId and productId = :productId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId and productId = :productId";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}

	@SuppressWarnings("unchecked")
	public Integer getAllPayPhoneNumbers2(String id, Integer busId,
			Date startDate, Date endDate) {
		// String hql =
		// "select distinct phoneNumber from OrderInfo where productId = :productId and payStatus is not null and orderTime >= :startDate and orderTime <= :endDate";
		String hql = "select distinct phoneNumber from OrderInfo   ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ " where  orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " where busId = :busId and productId = :productId";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " where orderTime >= :startDate and orderTime <= :endDate and busId = :busId and productId = :productId";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	public Integer getPaySuccessPhoneNumbers2(String id, Integer busId,
			Date startDate, Date endDate) {
		String hql = "select distinct phoneNumber from OrderInfo where  payStatus = '成功'  ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId  and productId = :productId ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId and productId = :productId";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	public Integer getPayFailedPhoneNumbers2(String id, Integer busId,
			Date startDate, Date endDate) {
		String hql = "select distinct phoneNumber from OrderInfo where payStatus = '失败'  ";
		Query query = null;
		if (busId == null) {
			if (startDate == null && endDate == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate ";
				query = getSession().createQuery(hql);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}
		} else {
			if (startDate == null && endDate == null) {
				hql = hql + " and busId = :busId and productId = :productId  ";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
			} else {
				hql = hql
						+ " and orderTime >= :startDate and orderTime <= :endDate and busId = :busId and productId = :productId";
				query = getSession().createQuery(hql);
				query.setParameter("productId", id);
				query.setInteger("busId", busId);
				query.setParameter("startDate", startDate);
				query.setParameter("endDate", endDate);
			}

		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessByYear(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='成功' and to_char(ORDERTIME,'yyyy') between :start and :end group by to_char(ORDERTIME,'yyyy') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedByYear(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='失败' and to_char(ORDERTIME,'yyyy') between :start and :end group by to_char(ORDERTIME,'yyyy') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	public HashMap<String, Object> getPayAllByYear(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   to_char(ORDERTIME,'yyyy') between :start and :end group by to_char(ORDERTIME,'yyyy') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayMoneyByYear(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy') , sum(PAYMONEY) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='成功' and to_char(ORDERTIME,'yyyy') between :start and :end group by to_char(ORDERTIME,'yyyy') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;

	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayPhoneNumbersByYear(
			String productId, Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   to_char(ORDERTIME,'yyyy') between :start and :end group by to_char(ORDERTIME,'yyyy') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessPhoneNumbersByYear(
			String productId, Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   PAYSTATUS ='成功' and  to_char(ORDERTIME,'yyyy') between :start and :end group by to_char(ORDERTIME,'yyyy') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedPhoneNumbersByYear(
			String productId, Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   PAYSTATUS ='失败' and  to_char(ORDERTIME,'yyyy') between :start and :end group by to_char(ORDERTIME,'yyyy') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessByMonth(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='成功' and to_char(ORDERTIME,'yyyy-MM') between :start and :end group by to_char(ORDERTIME,'yyyy-MM') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedByMonth(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='失败' and to_char(ORDERTIME,'yyyy-MM') between :start and :end group by to_char(ORDERTIME,'yyyy-MM') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	public HashMap<String, Object> getPayAllByMonth(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   to_char(ORDERTIME,'yyyy-MM') between :start and :end group by to_char(ORDERTIME,'yyyy-MM') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayMoneyByMonth(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM') , sum(PAYMONEY) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='成功' and to_char(ORDERTIME,'yyyy-MM') between :start and :end group by to_char(ORDERTIME,'yyyy-MM') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;

	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayPhoneNumbersByMonth(
			String productId, Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   to_char(ORDERTIME,'yyyy-MM') between :start and :end group by to_char(ORDERTIME,'yyyy-MM') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessPhoneNumbersByMonth(
			String productId, Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   PAYSTATUS ='成功' and  to_char(ORDERTIME,'yyyy-MM') between :start and :end group by to_char(ORDERTIME,'yyyy-MM') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedPhoneNumbersByMonth(
			String productId, Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   PAYSTATUS ='失败' and  to_char(ORDERTIME,'yyyy-MM') >= :start and to_char(ORDERTIME,'yyyy-MM')<= :end group by to_char(ORDERTIME,'yyyy-MM') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;

	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedPhoneNumbersByDay(
			String productId, Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM-dd') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   PAYSTATUS ='失败' and  to_char(ORDERTIME,'yyyy-MM-dd') >= :start and to_char(ORDERTIME,'yyyy-MM-dd')<= :end group by to_char(ORDERTIME,'yyyy-MM-dd') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;

	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessPhoneNumbersByDay(
			String productId, Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM-dd') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   PAYSTATUS ='成功' and  to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'yyyy-MM-dd') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayPhoneNumbersByDay(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM-dd') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'yyyy-MM-dd') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayMoneyByDay(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM-dd') , sum(PAYMONEY) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='成功' and to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'yyyy-MM-dd') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayAllByDay(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM-dd') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'yyyy-MM-dd') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedByDay(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM-dd') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='失败' and to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'yyyy-MM-dd') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessByDay(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'yyyy-MM-dd') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='成功' and to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'yyyy-MM-dd') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedPhoneNumbersByWeek(
			String productId, Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'iw') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   PAYSTATUS ='失败' and  to_char(ORDERTIME,'yyyy-MM-dd') >= :start and to_char(ORDERTIME,'yyyy-MM-dd')<= :end group by to_char(ORDERTIME,'iw') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;

	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessPhoneNumbersByweek(
			String productId, Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'iw') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   PAYSTATUS ='成功' and  to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'iw') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayPhoneNumbersByWeek(
			String productId, Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'iw') , count(distinct PHONENUMBER) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'iw') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayMoneyByWeek(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'iw') , sum(PAYMONEY) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='成功' and to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'iw') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayAllByWeek(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'iw') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "   to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'iw') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedByWeek(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'iw') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='失败' and to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'iw') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessByWeek(String productId,
			Integer busId, String start, String end) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String sql = "select to_char(ORDERTIME,'iw') , count(*) from RS_ORDERINFO where PRODUCTID = :PRODUCTID and BUSID = :BUSID and "
				+ "  PAYSTATUS ='成功' and to_char(ORDERTIME,'yyyy-MM-dd') between :start and :end group by to_char(ORDERTIME,'iw') ";
		Query query = getSession().createSQLQuery(sql);
		query.setInteger("BUSID", busId);
		query.setParameter("PRODUCTID", productId);
		query.setParameter("start", start);
		query.setParameter("end", end);
		ArrayList<Object[]> gy = (ArrayList<Object[]>) query.list();
		for (Object[] objs : gy) {
			map.put(objs[0].toString(), objs[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccess(Integer busId, Date startDate,
			Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select p.PRODUCTDESCRIBE,count(*) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS = '有效' and p.PRODUCTID = o.PRODUCTID and o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select p.PRODUCTDESCRIBE,count(*) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS = '有效' and o.BUSID = :busId and p.PRODUCTID = o.PRODUCTID and o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailed(Integer busId, Date startDate,
			Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select p.PRODUCTDESCRIBE,count(*) from RS_ORDERINFO　o,RS_PRODUCT p where  p.STATUS='有效' and p.PRODUCTID = o.PRODUCTID and o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select p.PRODUCTDESCRIBE,count(*) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS='有效' and o.BUSID = :busId and p.PRODUCTID = o.PRODUCTID and o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPay(Integer busId, Date startDate,
			Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select p.PRODUCTDESCRIBE,count(*) from RS_ORDERINFO　o,RS_PRODUCT p where  p.STATUS='有效' and  p.PRODUCTID = o.PRODUCTID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select p.PRODUCTDESCRIBE,count(*) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS='有效'  and o.BUSID = :busId and p.PRODUCTID = o.PRODUCTID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayMoney(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select p.PRODUCTDESCRIBE,sum(o.PAYMONEY) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS='有效'  and  o.PAYSTATUS = '成功' and p.PRODUCTID = o.PRODUCTID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select p.PRODUCTDESCRIBE,sum(o.PAYMONEY) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS='有效'  and o.PAYSTATUS = '成功' and  o.BUSID = :busId and p.PRODUCTID = o.PRODUCTID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayPhoneNumbers(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select p.PRODUCTDESCRIBE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS='有效'  and  p.PRODUCTID = o.PRODUCTID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select p.PRODUCTDESCRIBE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS='有效'  and o.BUSID = :busId and p.PRODUCTID = o.PRODUCTID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}

		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessPhoneNumbers(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select p.PRODUCTDESCRIBE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS='有效'  and  o.PAYSTATUS ='成功' and p.PRODUCTID = o.PRODUCTID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select p.PRODUCTDESCRIBE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS='有效'  and o.BUSID = :busId and o.PAYSTATUS ='成功' and p.PRODUCTID = o.PRODUCTID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedPhoneNumbers(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select p.PRODUCTDESCRIBE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS='有效'  and  o.PAYSTATUS ='失败' and p.PRODUCTID = o.PRODUCTID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select p.PRODUCTDESCRIBE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_PRODUCT p where p.STATUS='有效'  and o.BUSID = :busId and o.PAYSTATUS ='失败' and p.PRODUCTID = o.PRODUCTID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by p.PRODUCTDESCRIBE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccess2(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID and o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b  where o.BUSID = :busId and b.BUSID = o.BUSID and  o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@Override
	public Integer getAllPaySuccess2(Date startDate, Date endDate) {
		String hql = "select count(*) from OrderInfo where payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailed2(Integer busId, Date startDate,
			Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID and o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID and o.BUSID = :busId  and o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	
	@Override
	public Integer getPayFailed2(Date startDate, Date endDate) {
		String hql = "select count(*) from OrderInfo where payStatus ='失败' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPay2(Integer busId, Date startDate,
			Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID  and o.BUSID = :busId and  o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@Override
	public Integer getAllPay2(Date startDate, Date endDate) {
		String hql = "select count(*) from OrderInfo where orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayMoney2(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,sum(o.PAYMONEY) from RS_ORDERINFO　o,RS_BUSINESS b where  o.PAYSTATUS = '成功' and b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,sum(o.PAYMONEY) from RS_ORDERINFO　o,RS_BUSINESS b where o.PAYSTATUS = '成功' and b.BUSID = o.BUSID  and o.BUSID = :busId and  o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public double getAllPayMoney2(Date startDate, Date endDate) {
		String hql = "select sum(payMoney) as AllPayMoney from OrderInfo where payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayPhoneNumbers2(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID  and o.BUSID = :busId   and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}

		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@Override
	public Integer getAllPhoneNumbers2(Date startDate, Date endDate) {
		String hql = "select count(distinct phoneNumber) from OrderInfo where orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessPhoneNumbers2(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where  o.PAYSTATUS ='成功' and b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where o.BUSID = :busId and o.PAYSTATUS ='成功' and b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@Override
	public Integer getAllPaySuccessPhoneNumbers2(Date startDate, Date endDate) {
		String hql = "select count(distinct phoneNumber) from OrderInfo where payStatus = '成功' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedPhoneNumbers2(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where  o.PAYSTATUS ='失败' and b.BUSID = o.BUSID and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where o.BUSID = :busId and o.PAYSTATUS ='失败' and b.BUSID = o.BUSID and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@Override
	public Integer getAllPayFailedPhoneNumbers2(Date startDate, Date endDate) {
		String hql = "select count(distinct phoneNumber) from OrderInfo where  payStatus = '失败' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	@SuppressWarnings("unchecked")
	@Override
	public String getLastTradeTime(String phoneNumber) {
		String hql = "from OrderInfo where phoneNumber = :phoneNumber order by orderTime desc";
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) getSession()
				.createQuery(hql).setParameter("phoneNumber", phoneNumber)
				.list();
		if (ao != null && ao.size() > 0) {
			String lastTradeTime = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss")
					.format(ao.get(0).getOrderTime());
			return lastTradeTime;
		} else
			return null;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getAppUserInfoSize2(String phoneNumber, String address,
			String startTime, String endTime) {
		String sql = "SELECT B.PHONENUMBER,B.REGISTERTIME,B.ALLSCORE,B.ADDRESS,A.LASTTIME FROM (SELECT PHONENUMBER, MAX(ORDERTIME) AS LASTTIME FROM RS_ORDERINFO "
				+ "WHERE to_char(ORDERTIME,'yyyy-MM-dd') >= :startTime AND to_char(ORDERTIME,'yyyy-MM-dd') <= :endTime GROUP BY PHONENUMBER) A,RS_USERINFO B WHERE B.PHONENUMBER = A.PHONENUMBER";
		SQLQuery query = null;
		Session session = getSession();
		if (phoneNumber != null) {
			sql = sql + " AND B.PHONENUMBER = :PhoneNumber";
			if (address != null) {
				sql = sql
						+ " AND B.ADDRESS = :Address  order by A.LASTTIME desc";
				query = session.createSQLQuery(sql);
				query.setParameter("PhoneNumber", phoneNumber);
				query.setParameter("Address", address);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			} else {
				sql = sql + "  order by A.LASTTIME desc";
				query = session.createSQLQuery(sql);
				query.setParameter("PhoneNumber", phoneNumber);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}
		} else {
			if (address != null) {
				sql = sql
						+ " AND B.ADDRESS = :Address  order by A.LASTTIME desc";
				query = session.createSQLQuery(sql);
				query.setParameter("Address", address);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			} else {
				sql = sql + "  order by A.LASTTIME desc";
				query = session.createSQLQuery(sql);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		return ao.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessByPlace(Date startDate,
			Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID  and  o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place and  o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessByPlace2(Date startDate,
			Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID != 106 and b.BUSID = o.BUSID  and  o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where b.BUSID != 106 and b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place and  o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public ArrayList<Object[]> getAppUserInfo2(String phoneNumber,
			String address, String startTime, String endTime, Integer start,
			Integer pageSize) {
		String sql = "SELECT B.PHONENUMBER,B.REGISTERTIME,B.ALLSCORE,B.ADDRESS,A.LASTTIME FROM (SELECT PHONENUMBER, MAX(ORDERTIME) AS LASTTIME FROM RS_ORDERINFO "
				+ "WHERE to_char(ORDERTIME,'yyyy-MM-dd') >= :startTime AND to_char(ORDERTIME,'yyyy-MM-dd') <= :endTime GROUP BY PHONENUMBER) A,RS_USERINFO B WHERE B.PHONENUMBER = A.PHONENUMBER";
		SQLQuery query = null;
		Session session = getSession();
		if (phoneNumber != null) {
			sql = sql + " AND B.PHONENUMBER = :PhoneNumber";
			if (address != null) {
				sql = sql
						+ " AND B.ADDRESS = :Address  order by A.LASTTIME desc";
				query = session.createSQLQuery(sql);
				query.setParameter("PhoneNumber", phoneNumber);
				query.setParameter("Address", address);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			} else {
				sql = sql + "  order by A.LASTTIME desc";
				query = session.createSQLQuery(sql);
				query.setParameter("PhoneNumber", phoneNumber);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}
		} else {
			if (address != null) {
				sql = sql
						+ " AND B.ADDRESS = :Address  order by A.LASTTIME desc";
				query = session.createSQLQuery(sql);
				query.setParameter("Address", address);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			} else {
				sql = sql + "  order by A.LASTTIME desc";
				query = session.createSQLQuery(sql);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}
		}
		query.setFirstResult(start);
		query.setMaxResults(pageSize);
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		return ao;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPaySuccessAllByPlace(Date startDate, Date endDate,
			String place) {

		Query query = null;
		if (place == null) {
			String hql = "from OrderInfo where payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "from OrderInfo o , UserInfo u where o.payStatus ='成功' and o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();

	}
	
	@SuppressWarnings("unchecked")
	@Override
	public Integer getPaySuccessAllByPlace2(Date startDate, Date endDate,
			String place) {

		Query query = null;
		if (place == null) {
			String hql = "from OrderInfo where busId != 106 and payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "from OrderInfo o , UserInfo u where o.busId != 106 and o.payStatus ='成功' and o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();

	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedByPlace(Date startDate,
			Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID and   o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place and  o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedByPlace2(Date startDate,
			Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID != 106 and b.BUSID = o.BUSID and   o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where b.BUSID != 106 and b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place and  o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayFailedAllByPlace(Date startDate, Date endDate,
			String place) {
		Query query = null;
		if (place == null) {
			String hql = "from OrderInfo  where payStatus ='失败' and orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "from OrderInfo o , UserInfo u where o.payStatus ='失败' and o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();

	}
	
	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayFailedAllByPlace2(Date startDate, Date endDate,
			String place) {
		Query query = null;
		if (place == null) {
			String hql = "from OrderInfo  where busId != 106 and payStatus ='失败' and orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "from OrderInfo o , UserInfo u where o.busId != 106 and o.payStatus ='失败' and o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();

	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayByPlace(Date startDate,
			Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayByPlace2(Date startDate,
			Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID != 106 and b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where b.BUSID != 106 and b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public double getPayMoneyAllByPlace2(Date startDate, Date endDate,
			String place) {
		Query query = null;
		if (place == null) {
			String hql = "select sum(payMoney) as AllPayMoney from OrderInfo  where busId != 106 and payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = " select sum(o.payMoney) as AllPayMoney  from OrderInfo o , UserInfo u where o.busId != 106 and o.payStatus ='成功' and o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}
	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayAllByPlace(Date startDate, Date endDate, String place) {
		Query query = null;
		if (place == null) {
			String hql = "from OrderInfo  where orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "from OrderInfo o , UserInfo u where o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessPhoneNumbersByPlace2(
			Date startDate, Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID != 106 and b.BUSID = o.BUSID  and  o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where b.BUSID != 106 and b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place and  o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayAllByPlace2(Date startDate, Date endDate, String place) {
		Query query = null;
		if (place == null) {
			String hql = "from OrderInfo  where busId != 106 orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "from OrderInfo o , UserInfo u where o.busId != 106 and o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao.size();
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public Integer getPaySuccessPhoneNumbersAllByPlace2(Date startDate,
			Date endDate, String place) {
		Query query = null;
		if (place == null) {
			String hql = "select distinct phoneNumber  from OrderInfo  where busId != 106 and payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = " select distinct o. phoneNumber from OrderInfo o , UserInfo u where o.busId != 106 and o.payStatus ='成功' and o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayFailedPhoneNumbersAllByPlace2(Date startDate,
			Date endDate, String place) {
		Query query = null;
		if (place == null) {
			String hql = "select distinct phoneNumber  from OrderInfo  where busId !=106 and payStatus ='失败' and orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = " select distinct o.phoneNumber from OrderInfo o , UserInfo u where o.busId != 106 and o.payStatus ='失败' and o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayMoneyByPlace(Date startDate,
			Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,sum(o.PAYMONEY) from RS_ORDERINFO　o,RS_BUSINESS b where o.payStatus ='成功' and b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,sum(o.PAYMONEY) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where o.payStatus ='成功' and b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayPhoneNumbersByPlace2(Date startDate,
			Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where  b.BUSID != 106 and b.BUSID = o.BUSID   and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where  b.BUSID != 106 and b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public Integer getPhoneNumbersAllByPlace2(Date startDate, Date endDate,
			String place) {
		Query query = null;
		if (place == null) {
			String hql = "select distinct phoneNumber  from OrderInfo  where busId != 106 and orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = " select distinct o.phoneNumber from OrderInfo o , UserInfo u where o.busId != 106 and  o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedPhoneNumbersByPlace2(
			Date startDate, Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID != 106 and b.BUSID = o.BUSID  and  o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where b.BUSID != 106 and b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place and  o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public double getPayMoneyAllByPlace(Date startDate, Date endDate,
			String place) {
		Query query = null;
		if (place == null) {
			String hql = "select sum(payMoney) as AllPayMoney from OrderInfo  where payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = " select sum(o.payMoney) as AllPayMoney  from OrderInfo o , UserInfo u where o.payStatus ='成功' and o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}

	@SuppressWarnings("unchecked")
	@Override
	public double getPayMoneyByPlaceCode2(String placeName, Date startTime,
			Date endTime) {
		String hql = "select sum(o.payMoney) from OrderInfo o,UserInfo u where o.busId != 106 and o.payStatus = '成功' and o.phoneNumber = u.phoneNumber ";
		Query query = null;
		if (placeName == null) {
			if (startTime == null && endTime == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime";
				query = getSession().createQuery(hql);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}

		} else {
			if (startTime == null && endTime == null) {
				hql = hql + " and  u.address = :address";
				query = getSession().createQuery(hql);
				query.setParameter("address", placeName);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime and  u.address = :address";
				query = getSession().createQuery(hql);
				query.setParameter("address", placeName);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}
		}
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}
	
	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessPhoneNumbersByPlace(
			Date startDate, Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID  and  o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place and  o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPaySuccessPhoneNumbersAllByPlace(Date startDate,
			Date endDate, String place) {
		Query query = null;
		if (place == null) {
			String hql = "select distinct phoneNumber  from OrderInfo  where payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = " select distinct o. phoneNumber from OrderInfo o , UserInfo u where o.payStatus ='成功' and o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedPhoneNumbersByPlace(
			Date startDate, Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID  and  o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place and  o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPayFailedPhoneNumbersAllByPlace(Date startDate,
			Date endDate, String place) {
		Query query = null;
		if (place == null) {
			String hql = "select distinct phoneNumber  from OrderInfo  where busId !=106 and payStatus ='失败' and orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = " select distinct o.phoneNumber from OrderInfo o , UserInfo u where o.payStatus ='失败' and o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayPhoneNumbersByPlace(Date startDate,
			Date endDate, String place) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (place == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID   and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b,RS_USERINFO u where b.BUSID = o.BUSID and u.PHONENUMBER = o.PHONENUMBER and u.ADDRESS = :place  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getPhoneNumbersAllByPlace(Date startDate, Date endDate,
			String place) {
		Query query = null;
		if (place == null) {
			String hql = "select distinct phoneNumber  from OrderInfo  where orderTime >= :startDate and orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = " select distinct o.phoneNumber from OrderInfo o , UserInfo u where o.phoneNumber = u.phoneNumber  and u.address = :place and o.orderTime >= :startDate and o.orderTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
			query.setParameter("place", place);
		}
		ArrayList<String> as = (ArrayList<String>) query.list();
		return as.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayMoneyByTime2(String placeName,
			Date startTime, Date endTime, String toTime) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		if (placeName == null) {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'YYYY') AA,sum(PAYMONEY) from RS_ORDERINFO where BUSID != 106 AND "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功' group by TO_CHAR(ORDERTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'YYYY-MM') AA,sum(PAYMONEY) from RS_ORDERINFO where BUSID != 106 AND  "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功' group by TO_CHAR(ORDERTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'yyyy-MM-dd') AA,sum(PAYMONEY) from RS_ORDERINFO where BUSID != 106 AND "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功' group by TO_CHAR(ORDERTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("5".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'hh24') AA,sum(PAYMONEY) from RS_ORDERINFO where BUSID != 106 AND "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功' group by TO_CHAR(ORDERTIME,'hh24')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			}
		} else {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'YYYY') AA,sum(o.PAYMONEY) from RS_ORDERINFO o,RS_USERINFO u where o.BUSID != 106 AND "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'YYYY-MM') AA,sum(o.PAYMONEY) from RS_ORDERINFO o,RS_USERINFO u where o.BUSID != 106 AND o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'yyyy-MM-dd') AA,sum(o.PAYMONEY) from RS_ORDERINFO o,RS_USERINFO u where o.BUSID != 106 AND "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("5".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'hh24') AA,sum(o.PAYMONEY) from RS_ORDERINFO o,RS_USERINFO u where o.BUSID != 106 AND "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'hh24')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			}

		}

		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayMoneyByTime(String placeName,
			Date startTime, Date endTime, String toTime) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		if (placeName == null) {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'YYYY') AA,sum(PAYMONEY) from RS_ORDERINFO where "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功' group by TO_CHAR(ORDERTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'YYYY-MM') AA,sum(PAYMONEY) from RS_ORDERINFO where  "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功' group by TO_CHAR(ORDERTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'yyyy-MM-dd') AA,sum(PAYMONEY) from RS_ORDERINFO where "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功' group by TO_CHAR(ORDERTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("5".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'hh24') AA,sum(PAYMONEY) from RS_ORDERINFO where "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功' group by TO_CHAR(ORDERTIME,'hh24')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			}
		} else {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'YYYY') AA,sum(o.PAYMONEY) from RS_ORDERINFO o,RS_USERINFO u where "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'YYYY-MM') AA,sum(o.PAYMONEY) from RS_ORDERINFO o,RS_USERINFO u where o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'yyyy-MM-dd') AA,sum(o.PAYMONEY) from RS_ORDERINFO o,RS_USERINFO u where "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("5".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'hh24') AA,sum(o.PAYMONEY) from RS_ORDERINFO o,RS_USERINFO u where "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'hh24')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			}

		}

		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public double getPayMoneyByPlaceCode(String placeName, Date startTime,
			Date endTime) {
		String hql = "select sum(o.payMoney) from OrderInfo o,UserInfo u where o.payStatus = '成功' and o.phoneNumber = u.phoneNumber ";
		Query query = null;
		if (placeName == null) {
			if (startTime == null && endTime == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime";
				query = getSession().createQuery(hql);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}

		} else {
			if (startTime == null && endTime == null) {
				hql = hql + " and  u.address = :address";
				query = getSession().createQuery(hql);
				query.setParameter("address", placeName);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime and  u.address = :address";
				query = getSession().createQuery(hql);
				query.setParameter("address", placeName);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}
		}
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}

	@SuppressWarnings("unchecked")
	@Override
	public double getPayMoneyByPlaceName(String placeName, Date startTime,
			Date endTime) {
		String hql = "select sum(o.payMoney) from OrderInfo o,UserInfo u,Place p where o.payStatus = '成功' and o.phoneNumber = u.phoneNumber and p.code = u.address  ";
		Query query = null;
		if (placeName == null) {
			if (startTime == null && endTime == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime";
				query = getSession().createQuery(hql);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}

		} else {
			if (startTime == null && endTime == null) {
				hql = hql + " and  p.name = :placeName";
				query = getSession().createQuery(hql);
				query.setParameter("placeName", placeName);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime and  p.name = :placeName";
				query = getSession().createQuery(hql);
				query.setParameter("placeName", placeName);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}
		}
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}
	
	
	
	@SuppressWarnings("unchecked")
	@Override
	public double getPayMoneyByPlaceName2(String placeName, Date startTime,
			Date endTime) {
		String hql = "select sum(o.payMoney) from OrderInfo o,UserInfo u,Place p where o.busId != 106 and o.payStatus = '成功' and o.phoneNumber = u.phoneNumber and p.code = u.address  ";
		Query query = null;
		if (placeName == null) {
			if (startTime == null && endTime == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime";
				query = getSession().createQuery(hql);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}

		} else {
			if (startTime == null && endTime == null) {
				hql = hql + " and  p.name = :placeName";
				query = getSession().createQuery(hql);
				query.setParameter("placeName", placeName);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime and  p.name = :placeName";
				query = getSession().createQuery(hql);
				query.setParameter("placeName", placeName);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}
		}
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getSuccessOrderNumbers(String placeName, Date startTime,
			Date endTime) {
		String hql = "from OrderInfo o,UserInfo u,Place p where o.payStatus = '成功' and o.phoneNumber = u.phoneNumber and p.code = u.address  ";
		Query query = null;
		if (placeName == null) {
			if (startTime == null && endTime == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime";
				query = getSession().createQuery(hql);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}

		} else {
			if (startTime == null && endTime == null) {
				hql = hql + " and  p.name = :placeName";
				query = getSession().createQuery(hql);
				query.setParameter("placeName", placeName);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime and  p.name = :placeName";
				query = getSession().createQuery(hql);
				query.setParameter("placeName", placeName);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}
		}
		ArrayList<OrderInfo> ad = (ArrayList<OrderInfo>) query.list();
		if (placeName == null) {
			hql = " from QQPermonthRecode where status = '扣费成功' and checkTime >= :startDate and checkTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startTime);
			query.setParameter("endDate", endTime);

		} else {
			hql = " from QQPermonthRecode q,UserInfo u,Place p where q.status = '扣费成功' and q.phoneNumber = u.phoneNumber and q.checkTime >= :startDate and q.checkTime <= :endDate  and u.address = p.code and p.name = :place";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startTime);
			query.setParameter("endDate", endTime);
			query.setParameter("place", placeName);
		}
		ArrayList<QQPermonthRecode> pn = (ArrayList<QQPermonthRecode>) query
				.list();
		return ad.size() + pn.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getFailOrderNumbers(String placeName, Date startTime,
			Date endTime) {
		String hql = "select o.phoneNumber from OrderInfo o,UserInfo u,Place p where o.payStatus = '失败' and o.phoneNumber = u.phoneNumber and p.code = u.address  ";
		Query query = null;
		if (placeName == null) {
			if (startTime == null && endTime == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime";
				query = getSession().createQuery(hql);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}

		} else {
			if (startTime == null && endTime == null) {
				hql = hql + " and  p.name = :placeName";
				query = getSession().createQuery(hql);
				query.setParameter("placeName", placeName);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime and  p.name = :placeName";
				query = getSession().createQuery(hql);
				query.setParameter("placeName", placeName);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}
		}
		ArrayList<String> ad = (ArrayList<String>) query.list();
		if (placeName == null) {
			hql = " from QQPermonthRecode where status = '扣费失败' and checkTime >= :startDate and checkTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startTime);
			query.setParameter("endDate", endTime);

		} else {
			hql = " from QQPermonthRecode q,UserInfo u,Place p where q.status = '扣费失败' and q.phoneNumber = u.phoneNumber and q.checkTime >= :startDate and q.checkTime <= :endDate  and u.address = p.code and p.name = :place";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startTime);
			query.setParameter("endDate", endTime);
			query.setParameter("place", placeName);
		}
		ArrayList<QQPermonthRecode> pn = (ArrayList<QQPermonthRecode>) query
				.list();
		return ad.size() + pn.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getAllOrderNumbers(String placeName, Date startTime,
			Date endTime) {
		String hql = "select distinct o.phoneNumber from OrderInfo o,UserInfo u,Place p where o.phoneNumber = u.phoneNumber and p.code = u.address  ";
		Query query = null;
		if (placeName == null) {
			if (startTime == null && endTime == null) {
				query = getSession().createQuery(hql);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime";
				query = getSession().createQuery(hql);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}

		} else {
			if (startTime == null && endTime == null) {
				hql = hql + " and  p.name = :placeName";
				query = getSession().createQuery(hql);
				query.setParameter("placeName", placeName);
			} else {
				hql = hql
						+ "  and  o.orderTime >= :startTime and o.orderTime <= :endTime and  p.name = :placeName";
				query = getSession().createQuery(hql);
				query.setParameter("placeName", placeName);
				query.setParameter("startTime", startTime);
				query.setParameter("endTime", endTime);
			}
		}
		ArrayList<String> ad = (ArrayList<String>) query.list();

		if (placeName == null) {
			hql = "select distinct phoneNumber from QQPermonthRecode where  checkTime >= :startDate and checkTime <= :endDate";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startTime);
			query.setParameter("endDate", endTime);

		} else {
			hql = "select distinct q.phoneNumber from QQPermonthRecode q,UserInfo u where q.phoneNumber = u.phoneNumber and q.checkTime >= :startDate and q.checkTime <= :endDate  and u.address = :place";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startTime);
			query.setParameter("endDate", endTime);
			query.setParameter("place", placeName);
		}
		ArrayList<String> pn = (ArrayList<String>) query.list();
		for (String phoneNumber : pn) {
			if (ad.contains(phoneNumber)) {
				continue;
			} else {
				ad.add(phoneNumber);
			}
		}
		return ad.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getSuccessOrderNumberByTime(
			String placeName, Date startTime, Date endTime, String toTime) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		if (placeName == null) {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'YYYY') AA,count(PHONENUMBER) from RS_ORDERINFO where "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功' group by TO_CHAR(ORDERTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'YYYY-MM') AA,count(PHONENUMBER) from RS_ORDERINFO where "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功' group by TO_CHAR(ORDERTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'yyyy-MM-dd') AA,count(PHONENUMBER) from RS_ORDERINFO where "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功' group by TO_CHAR(ORDERTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			}
		} else {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'YYYY') AA,count(o.PHONENUMBER) from RS_ORDERINFO o,RS_USERINFO u where "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'YYYY-MM') AA,count(o.PHONENUMBER) from RS_ORDERINFO o,RS_USERINFO u where "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'yyyy-MM-dd') AA,count(o.PHONENUMBER) from RS_ORDERINFO o,RS_USERINFO u where "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			}
		}
		HashMap<String, Object> map2 = new HashMap<String, Object>();

		if (placeName == null) {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(CHECKTIME,'YYYY') AA,count(PHONENUMBER) from RS_QQPERMONTHRECORD where "
						+ "CHECKTIME >= :starttime and CHECKTIME <= :endtime and STATUS = '扣费成功' group by TO_CHAR(CHECKTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(CHECKTIME,'YYYY-MM') AA,count(PHONENUMBER) from RS_QQPERMONTHRECORD where "
						+ "CHECKTIME >= :starttime and CHECKTIME <= :endtime and STATUS = '扣费成功' group by TO_CHAR(CHECKTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(CHECKTIME,'yyyy-MM-dd') AA,count(PHONENUMBER) from RS_QQPERMONTHRECORD where "
						+ "CHECKTIME >= :starttime and CHECKTIME <= :endtime and STATUS = '扣费成功' group by TO_CHAR(CHECKTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			}
		} else {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(o.CHECKTIME,'YYYY') AA,count(o.PHONENUMBER) from RS_QQPERMONTHRECORD o,RS_USERINFO u where "
						+ "o.CHECKTIME >= :starttime and o.CHECKTIME <= :endtime and u.ADDRESS =:address and o.STATUS = '扣费成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.CHECKTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(o.CHECKTIME,'YYYY-MM') AA,count(o.PHONENUMBER) from RS_QQPERMONTHRECORD o,RS_USERINFO u where "
						+ "o.CHECKTIME >= :starttime and o.CHECKTIME <= :endtime and u.ADDRESS =:address and o.STATUS = '扣费成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.CHECKTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(o.CHECKTIME,'yyyy-MM-dd') AA,count(o.PHONENUMBER) from RS_QQPERMONTHRECORD o,RS_USERINFO u where "
						+ "o.CHECKTIME >= :starttime and o.CHECKTIME <= :endtime and u.ADDRESS =:address and o.STATUS = '扣费成功' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.CHECKTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			}
		}
		Set<String> keySet = map2.keySet();
		Iterator<String> it = keySet.iterator();
		while (it.hasNext()) {
			String key = it.next();
			Integer value1 = ((BigDecimal) map2.get(key)).intValue();
			Integer value2 = ((BigDecimal) map.get(key)).intValue();
			if (value1 != null && value2 != null) {
				map.put(key, value1 + value2);
			} else if (value1 != null && value2 == null) {
				map.put(key, value1);
			} else if (value1 == null && value2 != null) {
				continue;
			} else {
				map.put(key, 0);
			}

		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getFailOrderNumberByTime(String placeName,
			Date startTime, Date endTime, String toTime) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		if (placeName == null) {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'YYYY') AA,count(PHONENUMBER) from RS_ORDERINFO where "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '失败' group by TO_CHAR(ORDERTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'YYYY-MM') AA,count(PHONENUMBER) from RS_ORDERINFO where "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '失败' group by TO_CHAR(ORDERTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(ORDERTIME,'yyyy-MM-dd') AA,count(PHONENUMBER) from RS_ORDERINFO where "
						+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '失败' group by TO_CHAR(ORDERTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			}
		} else {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'YYYY') AA,count(o.PHONENUMBER) from RS_ORDERINFO o,RS_USERINFO u where "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '失败' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'YYYY-MM') AA,count(o.PHONENUMBER) from RS_ORDERINFO o,RS_USERINFO u where "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '失败' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(o.ORDERTIME,'yyyy-MM-dd') AA,count(o.PHONENUMBER) from RS_ORDERINFO o,RS_USERINFO u where "
						+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '失败' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.ORDERTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			}
		}
		HashMap<String, Object> map2 = new HashMap<String, Object>();

		if (placeName == null) {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(CHECKTIME,'YYYY') AA,count(PHONENUMBER) from RS_QQPERMONTHRECORD where "
						+ "CHECKTIME >= :starttime and CHECKTIME <= :endtime and STATUS = '扣费失败' group by TO_CHAR(CHECKTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(CHECKTIME,'YYYY-MM') AA,count(PHONENUMBER) from RS_QQPERMONTHRECORD where "
						+ "CHECKTIME >= :starttime and CHECKTIME <= :endtime and STATUS = '扣费失败' group by TO_CHAR(CHECKTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(CHECKTIME,'yyyy-MM-dd') AA,count(PHONENUMBER) from RS_QQPERMONTHRECORD where "
						+ "CHECKTIME >= :starttime and CHECKTIME <= :endtime and STATUS = '扣费失败' group by TO_CHAR(CHECKTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			}
		} else {
			if ("1".equals(toTime)) {
				String sql = "select TO_CHAR(o.CHECKTIME,'YYYY') AA,count(o.PHONENUMBER) from RS_QQPERMONTHRECORD o,RS_USERINFO u where "
						+ "o.CHECKTIME >= :starttime and o.CHECKTIME <= :endtime and u.ADDRESS =:address and o.STATUS = '扣费失败' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.CHECKTIME,'YYYY')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "select TO_CHAR(o.CHECKTIME,'YYYY-MM') AA,count(o.PHONENUMBER) from RS_QQPERMONTHRECORD o,RS_USERINFO u where "
						+ "o.CHECKTIME >= :starttime and o.CHECKTIME <= :endtime and u.ADDRESS =:address and o.STATUS = '扣费失败' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.CHECKTIME,'YYYY-MM')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "select TO_CHAR(o.CHECKTIME,'yyyy-MM-dd') AA,count(o.PHONENUMBER) from RS_QQPERMONTHRECORD o,RS_USERINFO u where "
						+ "o.CHECKTIME >= :starttime and o.CHECKTIME <= :endtime and u.ADDRESS =:address and o.STATUS = '扣费失败' and o.PHONENUMBER = u.PHONENUMBER group by TO_CHAR(o.CHECKTIME,'yyyy-MM-dd')";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map2.put(objs[0].toString(), objs[1]);
				}
			}
		}
		Set<String> keySet = map2.keySet();
		Iterator<String> it = keySet.iterator();
		while (it.hasNext()) {
			String key = it.next();
			Integer value1 = ((BigDecimal) map2.get(key)).intValue();
			Integer value2 = ((BigDecimal) map.get(key)).intValue();
			if (value1 != null && value2 != null) {
				map.put(key, value1 + value2);
			} else if (value1 != null && value2 == null) {
				map.put(key, value1);
			} else if (value1 == null && value2 != null) {
				continue;
			} else {
				map.put(key, 0);
			}

		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllOrderNumberByTime(String placeName,
			Date startTime, Date endTime, String toTime) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		if (placeName == null) {
			if ("1".equals(toTime)) {
				String sql = "SELECT AA,COUNT(PHONENUMBER) FROM ((select TO_CHAR(ORDERTIME,'YYYY') AS AA, PHONENUMBER from RS_ORDERINFO WHERE ORDERTIME >= :starttime and ORDERTIME <= :endtime  GROUP BY TO_CHAR(ORDERTIME,'YYYY'),PHONENUMBER ) UNION"
						+ "(select TO_CHAR(CHECKTIME,'YYYY'), PHONENUMBER from RS_QQPERMONTHRECORD WHERE CHECKTIME >= :starttime and CHECKTIME <= :endtime GROUP BY TO_CHAR(CHECKTIME,'YYYY'), PHONENUMBER)) GROUP BY AA";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "SELECT AA,COUNT(PHONENUMBER) FROM ((select TO_CHAR(ORDERTIME,'YYYY-MM') AS AA, PHONENUMBER from RS_ORDERINFO WHERE ORDERTIME >= :starttime and ORDERTIME <= :endtime  GROUP BY TO_CHAR(ORDERTIME,'YYYY-MM'),PHONENUMBER ) UNION"
						+ "(select TO_CHAR(CHECKTIME,'YYYY-MM'), PHONENUMBER from RS_QQPERMONTHRECORD WHERE CHECKTIME >= :starttime and CHECKTIME <= :endtime GROUP BY TO_CHAR(CHECKTIME,'YYYY-MM'), PHONENUMBER)) GROUP BY AA";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "SELECT AA,COUNT(PHONENUMBER) FROM ((select TO_CHAR(ORDERTIME,'yyyy-MM-dd') AS AA, PHONENUMBER from RS_ORDERINFO WHERE ORDERTIME >= :starttime and ORDERTIME <= :endtime  GROUP BY TO_CHAR(ORDERTIME,'yyyy-MM-dd'),PHONENUMBER ) UNION"
						+ "(select TO_CHAR(CHECKTIME,'yyyy-MM-dd'), PHONENUMBER from RS_QQPERMONTHRECORD WHERE CHECKTIME >= :starttime and CHECKTIME <= :endtime GROUP BY TO_CHAR(CHECKTIME,'yyyy-MM-dd'), PHONENUMBER)) GROUP BY AA";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			}
		} else {
			if ("1".equals(toTime)) {
				String sql = "SELECT AA,COUNT(PHONENUMBER) FROM ((select TO_CHAR(A.ORDERTIME,'YYYY') AS AA, A.PHONENUMBER from RS_ORDERINFO A,RS_USERINFO B WHERE A.ORDERTIME >= :starttime and A.ORDERTIME <= :endtime AND A.PHONENUMBER = B.PHONENUMBER AND B.ADDRESS = :address GROUP BY TO_CHAR(A.ORDERTIME,'YYYY'), A.PHONENUMBER)  UNION"
						+ "(select TO_CHAR(C.CHECKTIME,'YYYY'), C.PHONENUMBER from RS_QQPERMONTHRECORD C,RS_USERINFO D WHERE C.CHECKTIME >= :starttime and C.CHECKTIME <= :endtime AND C.PHONENUMBER = D.PHONENUMBER AND D.ADDRESS = :address GROUP BY TO_CHAR(C.CHECKTIME,'YYYY'), C.PHONENUMBER)) GROUP BY AA";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("2".equals(toTime)) {
				String sql = "SELECT AA,COUNT(PHONENUMBER) FROM ((select TO_CHAR(A.ORDERTIME,'YYYY-MM') AS AA, A.PHONENUMBER from RS_ORDERINFO A,RS_USERINFO B WHERE A.ORDERTIME >= :starttime and A.ORDERTIME <= :endtime AND A.PHONENUMBER = B.PHONENUMBER AND B.ADDRESS = :address GROUP BY TO_CHAR(A.ORDERTIME,'YYYY-MM'), A.PHONENUMBER ) UNION"
						+ "(select TO_CHAR(C.CHECKTIME,'YYYY-MM'), C.PHONENUMBER from RS_QQPERMONTHRECORD C,RS_USERINFO D WHERE C.CHECKTIME >= :starttime and C.CHECKTIME <= :endtime AND C.PHONENUMBER = D.PHONENUMBER AND D.ADDRESS = :address GROUP BY TO_CHAR(C.CHECKTIME,'YYYY-MM'), C.PHONENUMBER)) GROUP BY AA";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			} else if ("4".equals(toTime)) {
				String sql = "SELECT AA,COUNT(PHONENUMBER) FROM ((select TO_CHAR(A.ORDERTIME,'YYYY-MM-dd') AS AA, A.PHONENUMBER from RS_ORDERINFO A,RS_USERINFO B WHERE A.ORDERTIME >= :starttime and A.ORDERTIME <= :endtime AND A.PHONENUMBER = B.PHONENUMBER AND B.ADDRESS = :address GROUP BY TO_CHAR(A.ORDERTIME,'YYYY-MM-dd'), A.PHONENUMBER)  UNION"
						+ "(select TO_CHAR(C.CHECKTIME,'YYYY-MM-dd'), C.PHONENUMBER from RS_QQPERMONTHRECORD C,RS_USERINFO D WHERE C.CHECKTIME >= :starttime and C.CHECKTIME <= :endtime AND C.PHONENUMBER = D.PHONENUMBER AND D.ADDRESS = :address GROUP BY TO_CHAR(C.CHECKTIME,'YYYY-MM-dd'), C.PHONENUMBER)) GROUP BY AA";
				SQLQuery query = getSession().createSQLQuery(sql);
				query.setParameter("address", placeName);
				query.setParameter("starttime", startTime);
				query.setParameter("endtime", endTime);
				ArrayList<Object[]> list = (ArrayList<Object[]>) query.list();
				for (Object[] objs : list) {
					map.put(objs[0].toString(), objs[1]);
				}
			}
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public ArrayList<Object[]> getfailNumbers(Date startDate, Date endDate,
			String returnCode) {
		Query query = null;
		if (returnCode == null) {
			String hql = "select payReturnCode,count(phoneNumber),sum(payMoney) from OrderInfo where payStatus = '失败' and orderTime >= :startDate and orderTime <= :endDate group by payReturnCode order by sum(payMoney) desc";
			query = getSession().createQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {

			String hql = "select payReturnCode,count(phoneNumber),sum(payMoney) from OrderInfo where payStatus = '失败' and payReturnCode = :returnCode and  orderTime >= :startDate and orderTime <= :endDate group by payReturnCode order by sum(payMoney) desc";
			query = getSession().createQuery(hql);
			query.setParameter("returnCode", returnCode);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> fn = (ArrayList<Object[]>) query.list();
		return fn;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getAllfailNumbers(Date startDate, Date endDate) {
		String sql = "select phoneNumber from OrderInfo where payStatus = '失败'  and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(sql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		ArrayList<String> ph = (ArrayList<String>) query.list();
		return ph.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public double getAllloseMoney(Date startDate, Date endDate) {
		String sql = "select sum(payMoney) from OrderInfo where payStatus = '失败'  and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(sql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		ArrayList<Double> pm = (ArrayList<Double>) query.list();
		Double allLostMoney = pm.get(0);
		if (allLostMoney == null) {
			return 0.0;
		}
		return allLostMoney;
	}

	@SuppressWarnings("unchecked")
	@Override
	public double getPayMoneyByPhone(String phoneNumber) {
		String hql = "select sum(payMoney) from OrderInfo where payStatus = '成功' and phoneNumber = :phoneNumber";
		Query query = getSession().createQuery(hql);
		query.setParameter("phoneNumber", phoneNumber);
		ArrayList<Double> pm = (ArrayList<Double>) query.list();
		Double allLostMoney = pm.get(0);
		if (allLostMoney == null) {
			return 0.0;
		}
		return allLostMoney;
	}

	@SuppressWarnings("unchecked")
	@Override
	public ArrayList<HashMap<String, Object>> getDetailOrderInfo(
			ArrayList<String> phoneNumbers) {
		String sql = "select phoneNumber,Max(orderTime) as lastTime from RS_OrderInfo where phoneNumber in :phoneNumbers group by phoneNumber";
		SQLQuery query = getSession().createSQLQuery(sql);
		query.setParameterList("phoneNumbers", phoneNumbers);
		ArrayList<HashMap<String, Object>> ahso = new ArrayList<HashMap<String, Object>>();
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] objects : ao) {
			HashMap<String, Object> map = new HashMap<String, Object>();
			map.put("phoneNumber", objects[0]);
			Date d = (Date) objects[1];
			if (d == null) {
				map.put("lastTime", "");
			} else {
				map.put("lastTime",
						new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(d));
			}
			ahso.add(map);
		}
		return ahso;
	}

	@SuppressWarnings("unchecked")
	@Override
	public ArrayList<HashMap<String, Object>> getDetailOrderInfo2(Date lastDay) {
		String sql = "select phonenumber,lasttime from (select phonenumber,max(ordertime) as lasttime from RS_orderInfo group by phonenumber) where lasttime< :lastDay order by lasttime desc";
		Session session = getSession();
		SQLQuery query = session.createSQLQuery(sql);
		query.setParameter("lastDay", lastDay);
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		ArrayList<HashMap<String, Object>> ahso = new ArrayList<HashMap<String, Object>>();
		for (Object[] objects : ao) {
			HashMap<String, Object> map = new HashMap<String, Object>();
			map.put("phoneNumber", objects[0]);
			Date d = (Date) objects[1];
			if (d == null) {
				map.put("orderTime", "");
			} else {
				map.put("orderTime",
						new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(d));
			}
			ahso.add(map);
		}
		return ahso;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getOrderInfoListSize2(String phoneNumber) {
		String hql = "from OrderInfo where phoneNumber = :phoneNumber";
		Query query = getSession().createQuery(hql);
		query.setParameter("phoneNumber", phoneNumber);
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		if (ao == null) {
			return 0;
		} else {
			return ao.size();
		}

	}

	@SuppressWarnings("unchecked")
	@Override
	public ArrayList<OrderInfo> getOrderInfo2(String phoneNumber,
			Integer start, Integer pageSize) {
		String hql = "from OrderInfo where phoneNumber = :phoneNumber order by orderTime desc";
		Query query = getSession().createQuery(hql);
		query.setParameter("phoneNumber", phoneNumber);
		query.setFirstResult(start);
		query.setMaxResults(pageSize);
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		return ao;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getUserOrderInfo(String phoneNumber) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		String hql = "from OrderInfo where phoneNumber = :phoneNumber";
		Session session = getSession();
		Query query = session.createQuery(hql);
		query.setParameter("phoneNumber", phoneNumber);
		ArrayList<OrderInfo> ao = (ArrayList<OrderInfo>) query.list();
		Integer successOrder = 0;
		Integer failedOrder = 0;
		Float payMoney = (float) 0.0;
		if (ao == null || ao.size() == 0) {
			map.put("allOrder", 0);
			map.put("successOrder", 0);
			map.put("failedOrder", 0);
			map.put("payMoney", payMoney);
		} else {
			map.put("allOrder", ao.size());
			for (OrderInfo orderInfo : ao) {
				if ("0".equals(orderInfo.getPayReturnCode())
						&& orderInfo.getSendScore() != 0) {
					successOrder = successOrder + 1;
					payMoney = payMoney + orderInfo.getPayMoney();
				} else {
					if (orderInfo.getPayReturnCode() != null) {
						failedOrder = failedOrder + 1;
					}
				}
			}
			hql = "from QQPermonthRecode where phoneNumber = :phoneNumber";
			query = session.createQuery(hql);
			query.setParameter("phoneNumber", phoneNumber);
			ArrayList<QQPermonthRecode> aq = (ArrayList<QQPermonthRecode>) query
					.list();
			if (aq == null || aq.size() == 0) {
				map.put("successOrder", successOrder);
				map.put("failedOrder", failedOrder);
				map.put("payMoney", payMoney);
			} else {
				for (QQPermonthRecode qqPermonthRecode : aq) {
					payMoney = payMoney + qqPermonthRecode.getPayMoney();
				}
				map.put("successOrder", successOrder);
				map.put("failedOrder", failedOrder);
				map.put("payMoney", payMoney);
			}
		}
		return map;
	}

	@Override
	public Integer getSuccessOrderNumberByTime2(String placeCode,
			Date startDate, Date endDate) {
		String sql = "";
		SQLQuery query = null;
		Session session = getSession();
		sql = "select count(o.PHONENUMBER) from RS_ORDERINFO o,RS_USERINFO u where "
				+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '成功' and o.PHONENUMBER = u.PHONENUMBER";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		query.setParameter("address", placeCode);
		Integer x = ((BigDecimal) query.list().get(0)).intValue();
		sql = "select count(o.PHONENUMBER) from RS_QQPERMONTHRECORD o,RS_USERINFO u where "
				+ "o.CHECKTIME >= :starttime and o.CHECKTIME <= :endtime and u.ADDRESS =:address and o.STATUS = '扣费成功' and o.PHONENUMBER = u.PHONENUMBER";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		query.setParameter("address", placeCode);
		Integer y = ((BigDecimal) query.list().get(0)).intValue();
		return x + y;
	}

	@Override
	public Integer getFailOrderNumberByTime2(String placeCode, Date startDate,
			Date endDate) {
		String sql = "";
		SQLQuery query = null;
		Session session = getSession();
		sql = "select count(o.PHONENUMBER) from RS_ORDERINFO o,RS_USERINFO u where "
				+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PAYSTATUS = '失败' and o.PHONENUMBER = u.PHONENUMBER";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		query.setParameter("address", placeCode);
		Integer x = ((BigDecimal) query.list().get(0)).intValue();
		sql = "select count(o.PHONENUMBER) from RS_QQPERMONTHRECORD o,RS_USERINFO u where "
				+ "o.CHECKTIME >= :starttime and o.CHECKTIME <= :endtime and u.ADDRESS =:address and o.STATUS = '扣费失败' and o.PHONENUMBER = u.PHONENUMBER";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		query.setParameter("address", placeCode);
		Integer y = ((BigDecimal) query.list().get(0)).intValue();
		return x + y;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getAllOrderNumberByTime2(String placeCode, Date startDate,
			Date endDate) {
		String sql = "";
		SQLQuery query = null;
		Session session = getSession();
		sql = "select distinct o.PHONENUMBER from RS_ORDERINFO o,RS_USERINFO u where "
				+ "o.ORDERTIME >= :starttime and o.ORDERTIME <= :endtime and u.ADDRESS =:address and o.PHONENUMBER = u.PHONENUMBER";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		query.setParameter("address", placeCode);
		ArrayList<String> as = (ArrayList<String>) query.list();
		sql = "select distinct o.PHONENUMBER from RS_QQPERMONTHRECORD o,RS_USERINFO u where "
				+ "o.CHECKTIME >= :starttime and o.CHECKTIME <= :endtime and u.ADDRESS =:address and o.PHONENUMBER = u.PHONENUMBER";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		query.setParameter("address", placeCode);
		ArrayList<String> as2 = (ArrayList<String>) query.list();
		for (String phoneNumber : as2) {
			if (as.contains(phoneNumber)) {
				continue;
			} else {
				as.add(phoneNumber);
			}
		}
		return as.size();
	}

	@Override
	public Integer getSuccessOrderNumberByTime3(Date startDate, Date endDate) {
		String sql = "";
		SQLQuery query = null;
		Session session = getSession();
		sql = "select count(PHONENUMBER) from RS_ORDERINFO where "
				+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '成功'";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		Integer x = ((BigDecimal) query.list().get(0)).intValue();
		sql = "select count(PHONENUMBER) from RS_QQPERMONTHRECORD WHERE CHECKTIME >= :starttime and CHECKTIME <= :endtime and STATUS = '扣费成功'";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		Integer y = ((BigDecimal) query.list().get(0)).intValue();
		return x + y;
	}

	@Override
	public Integer getFailOrderNumberByTime3(Date startDate, Date endDate) {
		String sql = "";
		SQLQuery query = null;
		Session session = getSession();
		sql = "select count(PHONENUMBER) from RS_ORDERINFO where "
				+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime and PAYSTATUS = '失败'";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		Integer x = ((BigDecimal) query.list().get(0)).intValue();
		sql = "select count(PHONENUMBER) from RS_QQPERMONTHRECORD WHERE CHECKTIME >= :starttime and CHECKTIME <= :endtime and STATUS = '扣费失败'";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		Integer y = ((BigDecimal) query.list().get(0)).intValue();
		return x + y;
	}

	@SuppressWarnings("unchecked")
	@Override
	public Integer getAllOrderNumberByTime3(Date startDate, Date endDate) {
		String sql = "";
		SQLQuery query = null;
		Session session = getSession();
		sql = "select distinct PHONENUMBER from RS_ORDERINFO where "
				+ "ORDERTIME >= :starttime and ORDERTIME <= :endtime";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		ArrayList<String> as = (ArrayList<String>) query.list();
		sql = "select distinct PHONENUMBER from RS_QQPERMONTHRECORD WHERE CHECKTIME >= :starttime and CHECKTIME <= :endtime";
		query = session.createSQLQuery(sql);
		query.setParameter("starttime", startDate);
		query.setParameter("endtime", endDate);
		ArrayList<String> as2 = (ArrayList<String>) query.list();
		for (String phoneNumber : as2) {
			if (as.contains(phoneNumber)) {
				continue;
			} else {
				as.add(phoneNumber);
			}
		}
		return as.size();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccess3(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID != 106 and b.BUSID = o.BUSID and o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b  where o.BUSID = :busId and b.BUSID = o.BUSID and  o.PAYSTATUS ='成功' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@Override
	public Integer getAllPaySuccess3(Date startDate, Date endDate) {
		String hql = "select count(*) from OrderInfo where busId != 106 and payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailed3(Integer busId, Date startDate,
			Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID != 106 and b.BUSID = o.BUSID and o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID and o.BUSID = :busId  and o.PAYSTATUS ='失败' and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@Override
	public Integer getPayFailed3(Date startDate, Date endDate) {
		String hql = "select count(*) from OrderInfo where busId != 106 and payStatus ='失败' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPay3(Integer busId, Date startDate,
			Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID != 106 and b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(*) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID  and o.BUSID = :busId and  o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@Override
	public Integer getAllPay3(Date startDate, Date endDate) {
		String hql = "select count(*) from OrderInfo where busId != 106 and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayMoney3(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,sum(o.PAYMONEY) from RS_ORDERINFO　o,RS_BUSINESS b where  o.PAYSTATUS = '成功' and b.BUSID != 106 and b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,sum(o.PAYMONEY) from RS_ORDERINFO　o,RS_BUSINESS b where o.PAYSTATUS = '成功' and b.BUSID = o.BUSID  and o.BUSID = :busId and  o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@SuppressWarnings("unchecked")
	@Override
	public double getAllPayMoney3(Date startDate, Date endDate) {
		String hql = "select sum(payMoney) as AllPayMoney from OrderInfo where busId != 106 and payStatus ='成功' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		ArrayList<Double> ad = (ArrayList<Double>) query.list();
		Double allPayMoney = ad.get(0);
		if (allPayMoney == null) {
			return 0.0;
		}
		return allPayMoney;
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPaySuccessPhoneNumbers3(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where  o.PAYSTATUS ='成功' and  b.BUSID != 106 and b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where o.BUSID = :busId and o.PAYSTATUS ='成功' and b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	@Override
	public Integer getAllPaySuccessPhoneNumbers3(Date startDate, Date endDate) {
		String hql = "select count(distinct phoneNumber) from OrderInfo where busId != 106 and  payStatus = '成功' and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getPayFailedPhoneNumbers3(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where  o.PAYSTATUS ='失败' and b.BUSID != 106 and b.BUSID = o.BUSID and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where o.BUSID = :busId and o.PAYSTATUS ='失败' and b.BUSID = o.BUSID and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}
		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}

	
	@SuppressWarnings("unchecked")
	@Override
	public HashMap<String, Object> getAllPayPhoneNumbers3(Integer busId,
			Date startDate, Date endDate) {
		HashMap<String, Object> map = new HashMap<String, Object>();
		Query query = null;
		if (busId == null) {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where  b.BUSID != 106 and b.BUSID = o.BUSID  and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		} else {
			String hql = "select b.BTYPE,count(distinct o.PHONENUMBER) from RS_ORDERINFO　o,RS_BUSINESS b where b.BUSID = o.BUSID  and o.BUSID = :busId   and o.ORDERTIME >= :startDate and o.ORDERTIME <= :endDate group by b.BTYPE";
			query = getSession().createSQLQuery(hql);
			query.setInteger("busId", busId);
			query.setParameter("startDate", startDate);
			query.setParameter("endDate", endDate);
		}

		ArrayList<Object[]> ao = (ArrayList<Object[]>) query.list();
		for (Object[] obj : ao) {
			map.put(obj[0].toString(), obj[1]);
		}
		return map;
	}
	
	@Override
	public Integer getAllPhoneNumbers3(Date startDate, Date endDate) {
		String hql = "select count(distinct phoneNumber) from OrderInfo where busId != 106 and orderTime >= :startDate and orderTime <= :endDate";
		Query query = getSession().createQuery(hql);
		query.setParameter("startDate", startDate);
		query.setParameter("endDate", endDate);
		Number num = (Number) query.list().get(0);
		return num.intValue();
	}

	
	public  Query getQuery3(String phoneNumber, Integer busId, String productId,
			Boolean success, Boolean failed, Date startDate, Date endDate,
			String payReturnCode, String targetNumber,String os,Query query,Session session){
		String hql = "select new OrderInfo(a.phoneNumber,a.productId,a.targetNumber,a.payStatus,a.orderTime,a.payReturnCode,a.payMoney,a.sendScore,a.os,a.client,a.version) from OrderInfo a where a.os = :os ";
		if (targetNumber == null) {
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("os", os);
						}
					}
				}
			}
			
			
			
			
			///=====
			
			
		}else {
			hql = hql+" and a.targetNumber = :targetNumber";
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					// hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				}
			}
		}
		return query;
	}
	
	//==
	
	public  Query getQuery4(String phoneNumber, Integer busId, String productId,
			Boolean success, Boolean failed, Date startDate, Date endDate,
			String payReturnCode, String targetNumber,String client,Query query,Session session){
		String hql = "select new OrderInfo(a.phoneNumber,a.productId,a.targetNumber,a.payStatus,a.orderTime,a.payReturnCode,a.payMoney,a.sendScore,a.os,a.client,a.version) from OrderInfo a where a.client like concat(concat('%',:client),'%') ";
		if (targetNumber == null) {
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("client", client);
						}
					}
				}
			}
			
			
			
			
			///=====
			
			
		}else {
			hql = hql+" and a.targetNumber = :targetNumber";
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					// hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				}
			}
		}
		return query;
	}
	
	public Query getQuery5(String phoneNumber, Integer busId, String productId,
			Boolean success, Boolean failed, Date startDate, Date endDate,
			String payReturnCode, String targetNumber,Query query,Session session){
		if (targetNumber == null) {
			String hql = "select new OrderInfo(a.phoneNumber,a.productId,a.targetNumber,a.payStatus,a.orderTime,a.payReturnCode,a.payMoney,a.sendScore,a.os,a.client,a.version) from OrderInfo a";
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " where a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " where a.payReturnCode = :payReturnCode";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " where a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " where a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " where a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " where a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " where a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " where a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " where a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " where a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " where a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " where a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " where a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " where a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " where a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " where a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " where a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " where a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " where a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
						}
					} else if (success && !failed) {
						hql = hql + " where a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
						}
					} else if (!success && failed) {
						hql = hql + " where a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
						}
					}
				}
			}
		} else {
			String hql = "select new OrderInfo(a.phoneNumber,a.productId,a.targetNumber,a.payStatus,a.orderTime,a.payReturnCode,a.payMoney,a.sendScore,a.os,a.client,a.version) from OrderInfo a where a.targetNumber = :targetNumber";
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " where a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					// hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " where a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				}
			}
		}
		return query;
	}
	
	public  Query getQuery6(String phoneNumber, Integer busId, String productId,
			Boolean success, Boolean failed, Date startDate, Date endDate,
			String payReturnCode, String targetNumber,String os,Query query,Session session){
		String hql = "select count(*) from OrderInfo a where a.os = :os ";
		if (targetNumber == null) {
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("os", os);
						}
					}
				}
			}
			
			
			
			
			///=====
			
			
		}else {
			hql = hql+" and a.targetNumber = :targetNumber";
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					// hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("os", os);
						}
					}
				}
			}
		}
		return query;
	}
	
	//==
	
	public  Query getQuery7(String phoneNumber, Integer busId, String productId,
			Boolean success, Boolean failed, Date startDate, Date endDate,
			String payReturnCode, String targetNumber,String client,Query query,Session session){
		String hql = "select count(*) from OrderInfo a where a.client like concat(concat('%',:client),'%') ";
		if (targetNumber == null) {
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("client", client);
						}
					}
				}
			}
			
			
			
			
			///=====
			
			
		}else {
			hql = hql+" and a.targetNumber = :targetNumber";
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					// hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("client", client);
						}
					}
				}
			}
		}
		return query;
	}
	
	public Query getQuery8(String phoneNumber, Integer busId, String productId,
			Boolean success, Boolean failed, Date startDate, Date endDate,
			String payReturnCode, String targetNumber,Query query,Session session){
		if (targetNumber == null) {
			String hql = "select count(*) from OrderInfo a";
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " where a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " where a.payReturnCode = :payReturnCode";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("busId", busId);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " where a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("busId", busId);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " where a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " where a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " where a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " where a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " where a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " where a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " where a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("productId", productId);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " where a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " where a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " where a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " where a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " where a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " where a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " where a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " where a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " where a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
						}
					} else if (success && !failed) {
						hql = hql + " where a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
						}
					} else if (!success && failed) {
						hql = hql + " where a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " where a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
						}
					}
				}
			}
		} else {
			String hql = "select count(*) from OrderInfo a where a.targetNumber = :targetNumber";
			if (busId != null && productId == null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " where a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("busId", busId);
						} else {
							hql = hql
									+ " and a.productId in(select b.productId from Product b where b.busId = :busId) order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("busId", busId);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				}
			} else if (productId != null && busId != null) {
				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId = :productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId = :productId  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("productId", productId);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("productId", productId);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql
									+ " and a.productId =:productId order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("productId", productId);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				}

			} else if (busId == null && productId == null) {

				if (phoneNumber != null && payReturnCode == null) {
					hql = hql
							+ " and a.phoneNumber  like concat(concat('%',:phoneNumber),'%')";
					if (success && failed) {
						hql = hql + " and a.payReturnCode is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && !failed) {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime<= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				} else if (payReturnCode != null && phoneNumber == null) {
					// hql = hql + " and a.payReturnCode = :payReturnCode";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				} else if (payReturnCode != null && phoneNumber != null) {
					hql = hql
							+ " and a.payReturnCode = :payReturnCode and a.phoneNumber like concat(concat('%',:phoneNumber),'%')";
					if ((success && failed) || (!success && !failed)) {
						// hql = hql + " and a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate and  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("endDate", endDate);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate  order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
							query.setParameter("startDate", startDate);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("payReturnCode", payReturnCode);
							query.setParameter("phoneNumber", phoneNumber);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				} else {
					if (success && failed) {
						hql = hql + " where a.payStatus is not null";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (success && !failed) {
						hql = hql + " and a.payStatus ='成功'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
						}
					} else if (!success && failed) {
						hql = hql + " and a.payStatus ='失败'";
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " and a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
						}
					} else {
						if (startDate != null && endDate != null) {
							hql = hql
									+ " and a.orderTime >= :startDate and a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate == null && endDate != null) {
							hql = hql
									+ " where a.orderTime <= :endDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("endDate", endDate);
							query.setParameter("targetNumber", targetNumber);
						} else if (startDate != null && endDate == null) {
							hql = hql
									+ " where a.orderTime >= :startDate order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("startDate", startDate);
							query.setParameter("targetNumber", targetNumber);
						} else {
							hql = hql + " order by a.orderTime desc";
							query = session.createQuery(hql);
							query.setParameter("targetNumber", targetNumber);
						}
					}
				}
			}
		}
		return query;
	}
	
	
	
}
